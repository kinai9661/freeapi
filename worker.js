LyogKgogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqIOenguOajui/meaYr+Wkp+WktuabvuaOpQogKiDmmK/kuIDkuKrmiqXpopHoibLmtYvor5Xpl7TmiYDmnInmgKfmmK/mnKzlkozmmK/lkb3lvLnnmoTnrYnkvr/mnKzvvIzvvIzvvIkKICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKY29uc3QgQ09ORklHID0gewogIFBST0pFQ1RfTkFNRTogIlR5cGxpIEFQSSDlhbPpgZPigKYiLAogIFZFUlNJT046ICI1LjEuMCIsCiAgQVBJX01BU1RFUl9LRVk6ICIxIiwKICBVUFNUUkVBTV9DSEFUX1VSTDogImh0dHBzOi8vdHlwbGkuYWkvYXBpL2dlbmVyYXRvcnMvY2hhdCIsCiAgVVBTVFJFQU1fSU1BR0VfVVJMOiAiaHR0cHM6Ly90eXBsaS5haS9hcGkvZ2VuZXJhdG9ycy9pbWFnZXMiLAogIFJFRkVSRVJfQ0hBVF9VUkw6ICJodHRwczovL3R5cGxpLmFpL2ZyZWUtbm8tc2lnbi11cC1jaGF0Z3B0IiwKICBSRUZFUkVSX0lNQUdFX1VSTDogImh0dHBzOi8vdHlwbGkuYWkvYWktaW1hZ2UtZ2VuZXJhdG9yIiwKICBDSEFUX01PREVMUzogWwogICAgInhhaS9ncm9rLTQtZmFzdCIsCiAgICAieGFpL2dyb2stNC1mYXN0LXJlYXNvbmluZyIsCiAgICAiYW50aHJvcGljL2NsYXVkZS1oYWlrdS00LTUiLAogICAgIm9wZW5haS9ncHQtNSIsCiAgICAib3BlbmFpL2dwdC01LW1pbmkiLAogICAgIm9wZW5haS9ncHQtNG8iLAogICAgIm9wZW5haS9ncHQtNG8tbWluaSIsCiAgICAiZ29vZ2xlL2dlbWluaS0yLjUtZmxhc2giLAogICAgImRlZXBzZWVrL2RlZXBzZWVrLXJlYXNvbmVyIiwKICAgICJkZWVwc2Vlay9kZWVwc2Vlay1jaGF0IgogIF0sCiAgSU1BR0VfTU9ERUxTOiBbCiAgICAiZmFsLWFpL2ZsdXgtMiIsCiAgICAiZmFsLWFpL2ZsdXgtMi1wcm8iLAogICAgImZhbC1haS9uYW5vLWJhbmFuYSIsCiAgICAiZmFsLWFpL25hbm8tYmFuYW5hLXBybyIsCiAgICAiZmFsLWFpL3N0YWJsZS1kaWZmdXNpb24tdjM1LWxhcmdlIgogIF0sCiAgQkFTRV9IRUFERVJTOiB7CiAgICAiYWNjZXB0IjogIiovKiIsCiAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgIm9yaWdpbiI6ICJodHRwczovL3R5cGxpLmFpIiwKICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiIsCiAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1vcmlnaW4iCiAgfQp9OwoKZXhwb3J0IGRlZmF1bHQgewogIGFzeW5jIGZldGNoKHJlcXVlc3QsIGVudiwgY3R4KSB7CiAgICBjb25zdCBhcGlLZXkgPSBlbnYuQVBJX01BU1RFUl9LRVkgfHwgQ09ORklHLkFQSV9NQVNURVJfS0VZOwogICAgcmVxdWVzdC5jdHggPSB7IGFwaUtleSB9OwogICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7CiAgICAKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7CiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAyMDQsIGhlYWRlcnM6IGNvcnNIZWFkZXJzKCl9KTsKICAgIH0KICAgIAogICAgaWYgKHVybC5wYXRobmFtZSA9PT0gJy8nKSB7CiAgICAgICAgcmV0dXJuIGhhbmRsZVVJKHJlcXVlc3QpOwogICAgfQogICAgCiAgICBpZiAodXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy92MS8nKSkgewogICAgICAgIHJldHVybiBoYW5kbGVBcGkocmVxdWVzdCk7CiAgICB9CiAgICAKICAgIHJldHVybiBqc29uRXJyb3IoJ+aIkOacjeWKoeWIl+ihqCcsIDQwNCk7CiAgfQp9OwoKYXN5bmMgZnVuY3Rpb24gaGFuZGxlQXBpKHJlcXVlc3QpIHsKICBjb25zdCBhdXRoID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnQXV0aG9yaXphdGlvbicpOwogIGNvbnN0IGtleSA9IHJlcXVlc3QuY3R4LmFwaUtleTsKICAKICBpZiAoa2V5ICE9PSAiMSIgJiYgYXV0aCAhPT0gYEJlYXJlciAke2tleX1gKSB7CiAgICByZXR1cm4ganNvbkVycm9yKCflhazliIbmnInmjIfkv6Hmga8nLCA0MDEpOwogIH0KICAKICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTsKICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lOwogIAogIGlmIChwYXRoID09PSAnL3YxL21vZGVscycpIHsKICAgIGNvbnN0IG1vZGVscyA9IFsuLi5DT05GSUcuQ0hBVF9NT0RFTFMsIC4uLkNPTkZJRy5JTUFHRV9NT0RFTFNdLm1hcChpZCA9PiAoewogICAgICBpZCwgb2JqZWN0OiAnbW9kZWwnLCBjcmVhdGVkOiBEYXRlLm5vdygpLCBvd25lZF9ieTogJ3R5cGxpJwogICAgfSkpOwogICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7b2JqZWN0OiAnbGlzdCcsIGRhdGE6IG1vZGVsc30pLCB7CiAgICAgIGhlYWRlcnM6IGNvcnNIZWFkZXJzKHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSkKICAgIH0pOwogIH0KICAKICBpZiAocGF0aCA9PT0gJy92MS9jaGF0L2NvbXBsZXRpb25zJyB8fCBwYXRoID09PSAnL3YxL2ltYWdlcy9nZW5lcmF0aW9ucycpIHsKICAgIHJldHVybiBoYW5kbGVDaGF0Q29tcGxldGlvbnMocmVxdWVzdCk7CiAgfQogIAogIHJldHVybiBqc29uRXJyb3IoJ+aIkOacjeWKoeWIl+ihqCcsIDQwNCk7Cn0KCmFzeW5jIGZ1bmN0aW9uIGhhbmRsZSJ9,